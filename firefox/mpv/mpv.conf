# ==========    GENERAL    ==========

ontop
geometry=x40%-0-0
autofit=80%x80%
force-seekable=yes
keep-open=yes
reset-on-next-file=pause
msg-color=yes                                   # Thêm màu cho console ouput khi xuất ra terminal
msg-module=yes
image-display-duration=inf                      # Không autoplay đối với hình ảnh
hr-seek=yes                                     # Bật khi có thể precise seeks, seeks sẽ không bị giới hạn bởi keyframes
vd-lavc-fast=yes
input-default-bindings=no
autocreate-playlist=filter
user-agent='Mozilla/5.0 (ChromiumStylePlatform) Cobalt/25.lts.30.1034943-gold (unlike Gecko), Unknown_TV_Unknown_0/Unknown (Unknown, Unknown)'
#log-file=

# ==========    Video Profile    ==========
vo=gpu-next
hwdec=auto-safe
gpu-api=d3d11
# gpu-api=vulkan                                # Sử dụng vulkan nếu OS là Linux
deinterlace=auto

# ==========    CACHE & STREAMING    ==========
cache=yes                                  
demuxer-max-bytes=1GiB                     
demuxer-readahead-secs=300                 
demuxer-max-back-bytes=500MiB              
#demuxer-lavf-format=mpegts
load-unsafe-playlists=yes

# ==========    NETWORK    ==========
network-timeout=50
stream-lavf-o-append=reconnect_on_http_error=4xx,5xx
stream-lavf-o-append=reconnect_delay_max=30
stream-lavf-o-append=reconnect_streamed=yes
#stream-lavf-o-append=reconnect_on_network_error=yes

# ==========    YT-DLP    ==========
script-opts=ytdl_hook-try_ytdl_first=yes,ytdl_hook-exclude="%.webm$|%.ts$|%.mp3$|%.m3u8$|%.m3u$|%.mkv$|%.mp4$|%.VOB$|%.wmv$|%.ogg$|%.mpd$|%.mov$|%.webm$|%.webp$|%.avi$|%.flv$|%.swf$|%.f4v$"

ytdl-raw-options=no-write-comments=,yes-playlist=,write-auto-subs=,sub-langs="en.*,vi.*"
ytdl-raw-options-append=extractor-args=youtube:player_client=tv,tv_embedded,web_embedded,web_creator,-android_sdkless

#ytdl-raw-options-append=sub-format=srt
#ytdl-raw-options=cookies-from-browser=firefox:
#ytdl-raw-options=mark-watched=

# ==========    DEBANDING    ==========

deband=no                                       # Chỉ nên bật khi video có banding. (Keybind=h)
deband-iterations=1                           	# https://mpv.io/manual/stable/#options-deband-iterations
deband-threshold=48                             # https://mpv.io/manual/stable/#options-deband-threshold
deband-range=32									# https://mpv.io/manual/stable/#options-deband-threshold
deband-grain=32                                 # https://mpv.io/manual/stable/#options-deband-grain

# ==========    ON SCREEN DISPLAY AND ON SCREEN CONTROLLER    ==========

osd-bar=no                                      # Sử dụng UOSC thay cho UI mặc định
osc=no                                          # Sử dụng UI morden-x thay cho mặc định
border=no                                       # Tắt title bar và border thay vào đó sử dụng của morden X
cursor-autohide=100                             # Trỏ chuột sẽ tử động ẩn sau ms
osd-level=1                                     # https://mpv.io/manual/stable/#options-osd-level
osd-duration=1000                               # Thời gian xuất hiện của OSD messages bằng ms
                                                # https://mpv.io/manual/stable/#options-hr-seek
# Tuỳ chỉnh style của OSD messages
osd-font="Aptos Narrow"
osd-font-size=48
osd-color='#FFFFFF'
osd-border-size=2.4
osd-shadow-offset=0.75
osd-bold=yes

# ==========    LANGUAGE PRIORITY    ==========

track-auto-selection=yes
alang=vi,vie,en,eng,                            # Thứ tự uy tiên ngôn ngữ của audio
slang=en,eng,vi,vie                             # Thứ tự uy tiên ngôn ngữ của subtitles
sid=no

# ==========    AUDIO    ==========

volume=100                                      # Âm lượng mặc định
audio-file-auto=fuzzy                           # Load source âm thanh bên ngoài có tên gần giống với video
volume-max=200                                  # Dung lượng tối đa cho phép. Qua mức 100 mpv sẽ boost âm lượng từ video nên có thể gây ra suy giảm chất lượng âm thanh.
audio-pitch-correction=yes                      # tự động chèn scaletempo khi phát ở tốc độ cao hơn

# ==========    SUBTITLES    ==========

demuxer-mkv-subtitle-preroll=yes                # https://mpv.io/manual/stable/#options-mkv-subtitle-preroll
sub-fix-timing=no                               # Do not try to fix gaps (which might make it worse in some cases).
sub-auto=fuzzy                                  # Load subtitle bên ngoài có tên gần giống với video
sub-file-paths-append=ass
sub-file-paths-append=srt
sub-file-paths-append=pgs
sub-file-paths-append=vob
sub-file-paths-append=sub
sub-file-paths-append=sup
sub-file-paths-append=subs
sub-file-paths-append=subtitles
# Các tuỳ chọn sau áp dụng với định dạng subtitles không có style riêng (VD: SRT, VTT...)
# Đây là style yêu thích của mình có thể điều chỉnh lại style theo sở thích riêng
sub-font="Aptos Narrow"
sub-font-size=52
sub-bold=yes
sub-color='#ffffff'
sub-border-color="#FF000000"
sub-shadow-color=0.0/0.0/0.0/0.70
sub-border-size=2.0
sub-shadow-offset=0.75
sub-spacing=0.0
sub-bold=yes						     
sub-use-margins=no
sub-gauss=0.05                         

# ==========    INTERPOLATION    ==========

# Tuỳ chọn filter cho nội suy temporal axis (frames).
tscale=nearest
interpolation=no
scale=bilinear
cscale=bilinear
dscale=bilinear
sws-scaler=fast-bilinear
dither=no
correct-downscaling=no
linear-downscaling=no
sigmoid-upscaling=no
hdr-compute-peak=no

# ==========   Tone-mapping   ==========
target-colorspace-hint=no                        # Buộc tonemapping HDR -> SDR nếu màn hình của bạn hỗ trợ HDR thì bật lên và bật HDR trong setting của Windows.
tone-mapping=spline
libplacebo-opts-append=gamut_expansion=yes       # Allows the gamut mapping function to expand the gamut, in cases where the target gamut exceeds that of the source
libplacebo-opts-append=perceptual_deadzone=0.4
libplacebo-opts-append=perceptual_strength=0.5

# ==========   Profiles   ==========
[quality-youtube]
profile-cond=string.find(path, 'youtube') ~= nil or string.find(path, 'youtu.be') ~= nil or string.find(path, 'yt.be') ~= nil
profile-restore=copy

#ytdl-format=bv[height<=?1080][vcodec*=?avc]+ba[acodec*=?opus]/270+ba/b
ytdl-format=bv[height<=?1080][protocol!*=?m3u8][vcodec!*=?vp9]+ba[protocol!*=?m3u8][format_note*=?original]/bv[height<=?1080][protocol!*=?m3u8][vcodec!*=?vp9]+ba[protocol!*=?m3u8]/137+ba/b

[stream-no-ytdl]
profile-cond=string.find(path, '%.m3u') ~= nil or string.find(path, '%.mpd') ~= nil or string.find(path, '%.mp4') ~= nil or string.find(path, 'googlevideo%.') ~= nil or string.find(path, '%.jpg') ~= nil or string.find(path, '%.png') ~= nil or string.find(path, '%.epg') ~= nil or string.find(path, '%.ts') ~= nil or string.find(path, '%.xml') ~= nil or string.find(path, 'epg') ~= nil or string.find(path, 'EXTM3U') ~= nil
profile-restore=copy-equal
ytdl=no